language: java
cache:
  directories:
  - $HOME/.m2/repository

sudo: required

jdk:
  - oraclejdk8

services:
  - docker


before_install:
  - sudo service mysql-5.6 stop || sudo service mysql stop
  - sudo /etc/init.d/postgresql stop
  - sudo apt-get install jsvc
  - integration_test/prepare.sh

install: true

script: 
  - mvn docker:start
  - integration_test/produce_data.sh
  # - integration_test/test.sh

after_script:
  - mvn clean
  - mvn docker:stop